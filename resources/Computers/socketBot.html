<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <title>Обслуживание компьютерной техники</title>
    <style>
        @import url("css/bootstrap.css");
        @import url("css/bootstrap-grid.css");
        @import url("css/bootstrap-reboot.css");
        @import url("css/bootstrap-grid.min.css");
        @import url("css/bootstrap-utilities.css");
        @import url("css/bootstrap.rtl.css");
        @import url("css/bootstrap.min.css");
        @import url("js/bootstrap.bundle.js");
        @import url("js/bootstrap.js");
        @import url("js/bootstrap.esm.js");
        @import url("js/bootstrap.min.js");

    </style>
    <script>
        let str = window.location.href //получаем адрес страницы (http://127.0.0.1/demo)
        let res = str.split("/") //получаем массив данных, разделенных слешем
        ip_adress = res[2] //берем только ip (127.0.0.1)
        var ws = new WebSocket("ws://" + ip_adress + "/") // создаем веб-сокет по нужному адресу
        ws.onopen = function() { // функция, срабатывающая при подключении к сокету
            console.log('connection established') // отладочный вывод
            ws.send("StartBot") // отправляем серверу строку StartBot
        }
        ws.onclose = function() { // функция, срабатывающая закрытии сокета
            console.log('connection closed') // отладочный вывод
        }
        ws.onerror = function(err) { // функция, срабатывающая при ошибках
            console.log('error: ', err) // отладочный вывод
        }
        ws.onmessage = function(message) { // функция, срабатывающая при получении сообщений
            var receivedData = message.data // берем данные, переданные в сообщении
            console.log("receivedData = ", receivedData) // отладочный вывод
            let textArea = document.getElementById("Text") // находим область для вывода текста
            textArea.innerHTML = textArea.innerHTML + " <p style = 'color: green'>" + "Bot: " + receivedData
        } // и выводим в нее полученный текст

    </script>
</head>
<div>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
</div>

<body style="background-color:floralwhite;">
   <nav class="navbar navbar-expand-lg navbar-dark bg-dark" style="font-size:24px;">
  <a class="navbar-brand" style="font-size:24px;" href="#">Навигация</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="UserIndex.html">Домашняя страница</a>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Информация
        </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="About.html">О компании</a>
                        <a class="dropdown-item" href="UserContact.html">Контакты</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#"></a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="User.html">Пользователь</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link disabled" href="#"></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/Logout?login=User"></a>
                </li>
            </ul>
            <!--
    <form class="form-inline my-2 my-lg-0">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
-->
        </div>
        <span class="navbar-text" style="margin-right:10px; ">Добро пожаловать, Пользователь!</span>
    <ul class="navbar-nav mr-auto">
   <li class="nav-item">
    <a  class="nav-link" style="margin-right:20px;" href="/Logout?login=User">Выйти</a>
	</li>
	</ul>
    </nav>
    <div style="height:71px; background-color: papayawhip; padding-top: 20px;">
        <p class="h1" style="margin-left:20px; margin-top:0px; font-style:oblique; font-size:30px;">Обслуживание компьютерной техники</p>
        <hr/>
    </div>
    <div style="width:90%; height:740px; background-color: white; margin-left: 60px; border: 1px solid #e9d9e9; box-shadow: 0 0 3px black; margin-top: 40px; padding-bottom: 40px;">
    <div style="width:45%;height:600px;overflow:auto;float:left; margin-left: 50px;">
        <p class="h2" style="margin-left: 10px; margin-top: 50px; display: inline-block;">Чатбот</p>
        <!--<p class="h2" style="display: inline-block; margin-left: 40%; margin-right: 20%; text-align: right;">Команды</p>-->
        <form class="form-row">
            <div style="margin-left: 10px; margin-top: 10px">
                <input type="text" id="textToSend" placeholder="Введите команду чатботу..." class="form-control" style="width:50%; display:inline-block;">
                <button id="sendButton" onclick="sendText()" class="btn btn-outline-success" style="margin-bottom:5px; margin-left: 5px">Отправить</button>
            </div>
        </form>

        <script>
            function sendText() { // функция для обработки нажатия на кнопку
                let textToSend = document.getElementById("textToSend") //находим текстовое поле
                console.log("Text to send: ", textToSend.value) //отладочный вывод
                ws.send(textToSend.value) //отправляем текст, находящийся в текстовом поле
                let textArea = document.getElementById("Text") // находим область для вывода текста
                textArea.innerHTML = textArea.innerHTML + " <p style = 'color: blue'>" + "User: " +
                    textToSend.value //и выводим в нее текст
                textToSend.value = "" //очищаем текстовое поле
            }

        </script>
        <div id="Text" style="margin-left: 10px; margin-top: 10px; padding-bottom: 10px" class="h5"> text:
        </div>

    </div>
    <div style="width:50%;height:600px;overflow:auto;">
        <p class="h2" style="margin-left: 10px; margin-top: 50px; display: inline-block;">Список самых часто задаваемых команд</p>
        <div class="list-group" style="width:75%; margin-left: 10px; margin-top: 10px">
            <a href="#" class="list-group-item list-group-item-action" id="Где узнать контакты?" onclick="sendText2()"><p>Где узнать контакты?</p></a>
            <a href="#" class="list-group-item list-group-item-action" id="Где посмотреть список оборудования?" onclick="sendText3()"><p>Где  посмотреть список оборудования?</p></a>
            <a href="#" class="list-group-item list-group-item-action" id="Где узнать информацию о компании?" onclick="sendText4()"><p>Где узнать информацию о компании?</p></a>
            <a href="#" class="list-group-item list-group-item-action" id="Как подать заявку?" onclick="sendText5()"><p>Как подать заявку?</p></a>
            <a href="#" class="list-group-item list-group-item-action" id="Как закрыть чатбота?" onclick="sendText6()"><p>Как закрыть чатбота?</p></a>
        </div>
        <script>
            function sendText2() {
                document.getElementById("textToSend").value= document.getElementById("Где узнать контакты?").id
            };
            function sendText3() {
                document.getElementById("textToSend").value= document.getElementById("Где посмотреть список оборудования?").id
            };
            function sendText4() {
                document.getElementById("textToSend").value= document.getElementById("Где узнать информацию о компании?").id
            };
            function sendText5() {
                document.getElementById("textToSend").value= document.getElementById("Как подать заявку?").id
            };
            function sendText6() {
                document.getElementById("textToSend").value= document.getElementById("Как закрыть чатбота?").id
            };
        </script>
    </div>
</div>
</body>

</html>
